{"ast":null,"code":"import { useEffect, useRef } from 'react';\nimport { useFormState } from 'react-final-form';\nimport { useHistory } from 'react-router-dom';\nimport { useTranslate } from '../i18n';\n/**\n * Display a confirmation dialog if the form has unsaved changes.\n * - If the user confirms, the navigation continues and the changes are lost.\n * - If the user cancels, the navigation is cancelled and the changes are kept.\n */\n\nvar useWarnWhenUnsavedChanges = function (enable, formRootPathname) {\n  var history = useHistory();\n  var translate = useTranslate();\n\n  var _a = useFormState(UseFormStateSubscription),\n      pristine = _a.pristine,\n      submitSucceeded = _a.submitSucceeded;\n\n  var initialLocation = useRef(formRootPathname || history.location.pathname);\n  useEffect(function () {\n    if (!enable) {\n      return;\n    }\n\n    var release = history.block(function (location) {\n      var isInsideForm = location.pathname.startsWith(initialLocation.current);\n\n      if (!pristine && !isInsideForm && !submitSucceeded) {\n        return translate('ra.message.unsaved_changes');\n      }\n\n      return undefined;\n    });\n    return function () {\n      if (release) {\n        release();\n      }\n    };\n  }, [pristine, enable, history, translate, submitSucceeded]);\n};\n\nvar UseFormStateSubscription = {\n  // For some reason, subscribing only to pristine does not rerender when a field become dirty\n  // because it has a defaultValue (not initialValue as setting an initialValue does not make the field dirty)\n  subscription: {\n    pristine: true,\n    dirtyFields: true,\n    submitSucceeded: true\n  }\n};\nexport default useWarnWhenUnsavedChanges;","map":{"version":3,"sources":["/home/haroldo/cod/PosFullStack/UnidadeTeste/cyberTeste/user-admin/node_modules/ra-core/esm/form/useWarnWhenUnsavedChanges.js"],"names":["useEffect","useRef","useFormState","useHistory","useTranslate","useWarnWhenUnsavedChanges","enable","formRootPathname","history","translate","_a","UseFormStateSubscription","pristine","submitSucceeded","initialLocation","location","pathname","release","block","isInsideForm","startsWith","current","undefined","subscription","dirtyFields"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,YAAT,QAA6B,SAA7B;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,yBAAyB,GAAG,UAAUC,MAAV,EAAkBC,gBAAlB,EAAoC;AAChE,MAAIC,OAAO,GAAGL,UAAU,EAAxB;AACA,MAAIM,SAAS,GAAGL,YAAY,EAA5B;;AACA,MAAIM,EAAE,GAAGR,YAAY,CAACS,wBAAD,CAArB;AAAA,MAAiDC,QAAQ,GAAGF,EAAE,CAACE,QAA/D;AAAA,MAAyEC,eAAe,GAAGH,EAAE,CAACG,eAA9F;;AACA,MAAIC,eAAe,GAAGb,MAAM,CAACM,gBAAgB,IAAIC,OAAO,CAACO,QAAR,CAAiBC,QAAtC,CAA5B;AACAhB,EAAAA,SAAS,CAAC,YAAY;AAClB,QAAI,CAACM,MAAL,EAAa;AACT;AACH;;AACD,QAAIW,OAAO,GAAGT,OAAO,CAACU,KAAR,CAAc,UAAUH,QAAV,EAAoB;AAC5C,UAAII,YAAY,GAAGJ,QAAQ,CAACC,QAAT,CAAkBI,UAAlB,CAA6BN,eAAe,CAACO,OAA7C,CAAnB;;AACA,UAAI,CAACT,QAAD,IAAa,CAACO,YAAd,IAA8B,CAACN,eAAnC,EAAoD;AAChD,eAAOJ,SAAS,CAAC,4BAAD,CAAhB;AACH;;AACD,aAAOa,SAAP;AACH,KANa,CAAd;AAOA,WAAO,YAAY;AACf,UAAIL,OAAJ,EAAa;AACTA,QAAAA,OAAO;AACV;AACJ,KAJD;AAKH,GAhBQ,EAgBN,CAACL,QAAD,EAAWN,MAAX,EAAmBE,OAAnB,EAA4BC,SAA5B,EAAuCI,eAAvC,CAhBM,CAAT;AAiBH,CAtBD;;AAuBA,IAAIF,wBAAwB,GAAG;AAC3B;AACA;AACAY,EAAAA,YAAY,EAAE;AAAEX,IAAAA,QAAQ,EAAE,IAAZ;AAAkBY,IAAAA,WAAW,EAAE,IAA/B;AAAqCX,IAAAA,eAAe,EAAE;AAAtD;AAHa,CAA/B;AAKA,eAAeR,yBAAf","sourcesContent":["import { useEffect, useRef } from 'react';\nimport { useFormState } from 'react-final-form';\nimport { useHistory } from 'react-router-dom';\nimport { useTranslate } from '../i18n';\n/**\n * Display a confirmation dialog if the form has unsaved changes.\n * - If the user confirms, the navigation continues and the changes are lost.\n * - If the user cancels, the navigation is cancelled and the changes are kept.\n */\nvar useWarnWhenUnsavedChanges = function (enable, formRootPathname) {\n    var history = useHistory();\n    var translate = useTranslate();\n    var _a = useFormState(UseFormStateSubscription), pristine = _a.pristine, submitSucceeded = _a.submitSucceeded;\n    var initialLocation = useRef(formRootPathname || history.location.pathname);\n    useEffect(function () {\n        if (!enable) {\n            return;\n        }\n        var release = history.block(function (location) {\n            var isInsideForm = location.pathname.startsWith(initialLocation.current);\n            if (!pristine && !isInsideForm && !submitSucceeded) {\n                return translate('ra.message.unsaved_changes');\n            }\n            return undefined;\n        });\n        return function () {\n            if (release) {\n                release();\n            }\n        };\n    }, [pristine, enable, history, translate, submitSucceeded]);\n};\nvar UseFormStateSubscription = {\n    // For some reason, subscribing only to pristine does not rerender when a field become dirty\n    // because it has a defaultValue (not initialValue as setting an initialValue does not make the field dirty)\n    subscription: { pristine: true, dirtyFields: true, submitSucceeded: true },\n};\nexport default useWarnWhenUnsavedChanges;\n"]},"metadata":{},"sourceType":"module"}